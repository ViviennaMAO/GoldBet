<!-- pages/leaderboard/leaderboard.wxml -->
<view class="container">
  <!-- æ’è¡Œæ¦œç±»å‹åˆ‡æ¢ -->
  <view class="tabs">
    <view
      class="tab-item {{activeTab === 'points' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="points"
    >
      <text>ç§¯åˆ†æ¦œ</text>
    </view>
    <view
      class="tab-item {{activeTab === 'accuracy' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="accuracy"
    >
      <text>å‡†ç¡®ç‡æ¦œ</text>
    </view>
    <view
      class="tab-item {{activeTab === 'streak' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="streak"
    >
      <text>è¿èƒœæ¦œ</text>
    </view>
  </view>

  <!-- æˆ‘çš„æ’å -->
  <view wx:if="{{myRank}}" class="my-rank card">
    <view class="rank-badge my">
      <text class="rank-number">{{myRank.rank}}</text>
    </view>
    <view class="rank-info">
      <text class="rank-address">{{myRank.address}}</text>
      <text class="rank-label">æˆ‘çš„æ’å</text>
    </view>
    <view class="rank-score">
      <text class="score-value">{{myRank.value}}</text>
      <text class="score-unit">{{myRank.unit}}</text>
    </view>
  </view>

  <!-- æ’è¡Œæ¦œåˆ—è¡¨ -->
  <view class="leaderboard-list">
    <view wx:if="{{leaderboard.length > 0}}">
      <view wx:for="{{leaderboard}}" wx:key="userId" class="rank-item {{index < 3 ? 'top-three' : ''}}">
        <!-- æ’åå¾½ç«  -->
        <view class="rank-badge {{index === 0 ? 'first' : index === 1 ? 'second' : index === 2 ? 'third' : ''}}">
          <text wx:if="{{index === 0}}" class="rank-medal">ğŸ¥‡</text>
          <text wx:elif="{{index === 1}}" class="rank-medal">ğŸ¥ˆ</text>
          <text wx:elif="{{index === 2}}" class="rank-medal">ï¿½ï¿½</text>
          <text wx:else class="rank-number">{{item.rank}}</text>
        </view>

        <!-- ç”¨æˆ·ä¿¡æ¯ -->
        <view class="rank-user">
          <text class="user-address">{{item.address}}</text>
          <view class="user-stats">
            <text class="stat-text">é¢„æµ‹: {{item.totalPredictions}}æ¬¡</text>
            <text wx:if="{{activeTab === 'accuracy'}}" class="stat-text">æ­£ç¡®: {{item.correctPredictions}}æ¬¡</text>
          </view>
        </view>

        <!-- åˆ†æ•° -->
        <view class="rank-score">
          <text class="score-value">{{item.value}}</text>
          <text class="score-unit">{{item.unit}}</text>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:else class="empty-state">
      <text class="empty-icon">ğŸ†</text>
      <text class="empty-text">æš‚æ— æ’è¡Œæ•°æ®</text>
    </view>
  </view>

  <!-- åˆ·æ–°æŒ‰é’® -->
  <view class="refresh-section">
    <button class="btn-refresh" bindtap="refreshLeaderboard">
      <text class="refresh-icon {{isRefreshing ? 'rotating' : ''}}">âŸ³</text>
      <text>åˆ·æ–°æ’è¡Œæ¦œ</text>
    </button>
  </view>
</view>
